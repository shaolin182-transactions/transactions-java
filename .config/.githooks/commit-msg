#!/usr/bin/env python3

import re
import sys

# Expression régulière pour valider les messages de commit selon la convention "Conventional Commits"
COMMIT_MSG_PATTERN = re.compile(
    r'^(build|chore|ci|docs|feat|fix|perf|refactor|revert|style|test|BREAKING CHANGE)(\(([a-zA-Z0-9\-_]+)\))?: ([a-zA-Z0-9\-_ ]+)$'
)

def validate_commit_message(commit_msg):
    if not COMMIT_MSG_PATTERN.match(commit_msg):
        print("Error: Commit message does not follow the Conventional Commits convention.")
        print("Example: feat(auth): add login functionality")
        sys.exit(1)

if __name__ == "__main__":
    commit_msg_file = sys.argv[1]
    with open(commit_msg_file, 'r') as file:
        commit_msg = file.read().strip()
        validate_commit_message(commit_msg)
